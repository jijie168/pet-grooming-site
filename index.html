<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Red Dolphin Pet Grooming | Chula Vista</title>
  <meta name="description" content="Premium pet grooming in Chula Vista. Book by SMS and add to your calendar." />

  <style>
    :root{
      --bg0:#070A12;
      --bg1:#0A1020;
      --card: rgba(255,255,255,.06);
      --card2: rgba(255,255,255,.045);
      --line: rgba(255,255,255,.12);
      --text:#F5F7FF;
      --muted: rgba(245,247,255,.72);
      --muted2: rgba(245,247,255,.58);
      --brand:#63B3FF;
      --brand2:#22C55E;
      --gold:#F7D37B;
      --danger:#FF7A7A;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --radius: 18px;
      --max: 1120px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;color:var(--text);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Noto Sans",sans-serif}
    body{
      background:
        radial-gradient(1200px 600px at 15% -10%, rgba(99,179,255,.20), transparent 60%),
        radial-gradient(900px 500px at 90% 0%, rgba(247,211,123,.14), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
    }
    a{color:inherit}
    .wrap{max-width:var(--max);margin:0 auto;padding:26px}
    .nav{
      position:sticky;top:0;z-index:50;
      backdrop-filter: blur(12px);
      background: rgba(7,10,18,.55);
      border-bottom:1px solid var(--line);
    }
    .nav-inner{max-width:var(--max);margin:0 auto;padding:14px 26px;display:flex;gap:14px;align-items:center;justify-content:space-between}
    .brand{
      display:flex;align-items:center;gap:10px;
      font-weight:900;letter-spacing:.2px;
    }
    .logo{
      width:28px;height:28px;border-radius:10px;
      background: radial-gradient(circle at 30% 30%, rgba(247,211,123,.9), rgba(99,179,255,.9));
      box-shadow: 0 0 0 6px rgba(99,179,255,.10);
    }
    .menu{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .menu a{
      padding:8px 10px;border-radius:12px;
      color:var(--muted);text-decoration:none;border:1px solid transparent;
      transition:.15s ease;
    }
    .menu a:hover{
      color:var(--text);border-color:var(--line);background:rgba(255,255,255,.06)
    }

    .card{
      background: linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:18px;
    }
    .hero{
      display:grid;grid-template-columns: 1.1fr .9fr;gap:16px;
      align-items:stretch;
    }
    @media (max-width: 920px){ .hero{grid-template-columns:1fr} }

    h1{margin:0 0 10px;font-size:38px;line-height:1.06;letter-spacing:-.5px}
    .sub{color:var(--muted);line-height:1.65;font-size:15.5px}
    .badge{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;
      border:1px solid rgba(247,211,123,.30);
      background: rgba(247,211,123,.10);
      color: rgba(255,255,255,.90);
      font-size:13px;font-weight:700
    }
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      padding:11px 14px;border-radius:14px;border:1px solid transparent;
      text-decoration:none;font-weight:850;cursor:pointer;transition:.15s ease;
      user-select:none;
    }
    .btn.primary{
      background: linear-gradient(90deg, rgba(99,179,255,.95), rgba(99,179,255,.75));
      border-color: rgba(99,179,255,.55);
      color:#06101F;
    }
    .btn.success{
      background: linear-gradient(90deg, rgba(34,197,94,.95), rgba(34,197,94,.70));
      border-color: rgba(34,197,94,.55);
      color:#06130B;
    }
    .btn.ghost{
      background: rgba(255,255,255,.06);
      border-color: var(--line);
      color: var(--text);
    }
    .btn:hover{transform: translateY(-1px)}
    .section{padding:16px 0}
    .section h2{margin:0 0 10px;font-size:24px;letter-spacing:-.2px}
    .muted{color:var(--muted)}
    .small{font-size:12px;color:var(--muted2)}
    .hr{height:1px;background:var(--line);margin:14px 0}

    /* Services */
    .grid2{display:grid;grid-template-columns: 1fr 1fr; gap:12px}
    @media (max-width: 900px){ .grid2{grid-template-columns:1fr} }
    .service-title{font-size:22px;font-weight:900;margin:0 0 6px}
    .service-sub{color:var(--muted);margin:0 0 8px;line-height:1.55}
    .service-list{margin:0;padding-left:18px;color:rgba(245,247,255,.88);line-height:1.6}

    /* Carousel */
    .carousel{
      position:relative;
      border-radius: 18px;
      overflow:hidden;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      box-shadow: var(--shadow);
      min-height: 360px;
    }
    .slides{
      display:flex;
      transition: transform .45s ease;
      will-change: transform;
      height: 360px;
    }
    .slide{
      min-width:100%;
      height:360px;
      position:relative;
      display:flex;
      align-items:flex-end;
      justify-content:flex-start;
      padding:16px;
      background: linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    }
    .slide img{
      position:absolute;inset:0;
      width:100%;height:100%;
      object-fit:cover;
      filter: saturate(1.05) contrast(1.05);
    }
    .overlay{
      position:absolute;inset:0;
      background:
        linear-gradient(180deg, rgba(0,0,0,.15), rgba(0,0,0,.72)),
        radial-gradient(800px 420px at 15% 15%, rgba(99,179,255,.18), transparent 60%);
    }
    .caption{
      position:relative;z-index:2;
      max-width: 520px;
      padding:12px 14px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(10,16,32,.55);
      backdrop-filter: blur(10px);
    }
    .cap-title{margin:0;font-weight:950;letter-spacing:-.2px}
    .cap-sub{margin:6px 0 0;color:var(--muted);line-height:1.5;font-size:13.5px}

    .navbtn{
      position:absolute;top:50%;
      transform:translateY(-50%);
      width:42px;height:42px;border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(10,16,32,.55);
      backdrop-filter: blur(10px);
      color:var(--text);
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;z-index:5;
      transition:.15s ease;
      user-select:none;
    }
    .navbtn:hover{background: rgba(10,16,32,.75)}
    .prev{left:12px}
    .next{right:12px}

    .dots{
      position:absolute;bottom:12px;right:12px;z-index:6;
      display:flex;gap:8px;align-items:center;
      padding:8px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(10,16,32,.45);
      backdrop-filter: blur(10px);
    }
    .dot{
      width:8px;height:8px;border-radius:99px;
      background: rgba(255,255,255,.35);
      cursor:pointer;
    }
    .dot.active{background: rgba(247,211,123,.92); box-shadow: 0 0 0 4px rgba(247,211,123,.12)}

    /* Booking form */
    label{display:block;font-size:13.5px;color:rgba(245,247,255,.90);margin:10px 0 6px}
    .req{color:rgba(255,180,180,.95);font-weight:900;margin-left:6px}
    input,select,textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline:none;
    }
    input:focus,select:focus,textarea:focus{
      border-color: rgba(99,179,255,.55);
      box-shadow: 0 0 0 4px rgba(99,179,255,.12);
    }
    textarea{min-height:96px;resize:vertical}
    .form-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:780px){.form-row{grid-template-columns:1fr}}
    .notice{
      padding:12px 14px;border-radius:14px;
      border:1px solid rgba(247,211,123,.28);
      background: rgba(247,211,123,.10);
      color: rgba(255,255,255,.90);
      font-size:14px;line-height:1.55;
    }
    .error,.ok{
      margin-top:10px;padding:10px 12px;border-radius:14px;
      display:none;font-size:14px;line-height:1.5;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
    }
    .error{border-color: rgba(255,122,122,.35); background: rgba(255,122,122,.10); color: rgba(255,220,220,.95)}
    .ok{border-color: rgba(34,197,94,.35); background: rgba(34,197,94,.10); color: rgba(220,255,235,.95)}

    /* Map */
    .map-wrap{border-radius:18px;overflow:hidden;border:1px solid var(--line);box-shadow:var(--shadow)}
    iframe{display:block;width:100%;height:340px;border:0}

    /* Floating buttons */
    .fab{
      position:fixed;right:16px;bottom:18px;
      display:flex;flex-direction:column;gap:10px;z-index:80
    }
    .fab a{
      display:inline-flex;align-items:center;gap:10px;
      background: rgba(10,16,32,.70);
      border:1px solid rgba(255,255,255,.14);
      padding:10px 12px;border-radius:999px;text-decoration:none;color:var(--text);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
    }
    .fab .call{border-color: rgba(34,197,94,.32)}
    .fab .sms{border-color: rgba(99,179,255,.32)}
  </style>
</head>

<body>
  <div class="nav">
    <div class="nav-inner">
      <div class="brand">
        <span class="logo"></span>
        <span>Red Dolphin Pet Grooming</span>
      </div>
      <div class="menu">
        <a href="#services">Services</a>
        <a href="#book">Book</a>
        <a href="#location">Location</a>
        <a href="#contact">Contact</a>
      </div>
    </div>
  </div>

  <div class="wrap">

    <!-- HERO -->
    <div class="section">
      <div class="hero">

        <div class="card">
          <span class="badge">Premium care â€¢ Clean finish â€¢ Fast booking</span>
          <h1>Luxury Grooming, Calm Experience.</h1>
          <div class="sub">
            Address: <b>1680 E Broadway Suite E, Chula Vista, CA 91911</b><br/>
            Phone: <b>(619) 754-0193</b><br/>
            Hours: <b>10:00 AM â€“ 6:00 PM</b> (Closed Tuesday)
          </div>

          <div class="row">
            <a class="btn success" href="tel:+16197540193">ðŸ“ž Call</a>
            <a class="btn primary" href="sms:+16197540193?&body=Hi%20I%20would%20like%20to%20book%20pet%20grooming.">ðŸ’¬ Text</a>
            <a class="btn ghost" href="#book">ðŸ“… Book Now</a>
          </div>

          <div class="hr"></div>
          <div class="small">
            Tip: Booking is easiest by text. After submit, we generate an Apple/Google Calendar file with a reminder <b>1 day before</b>.
          </div>
        </div>

        <!-- Carousel -->
        <div class="carousel" aria-label="Gallery carousel">
          <div class="slides" id="slides">
            <!-- Slide 1 -->
            <div class="slide">
              <img src="assets/1.jpg" alt="Red Dolphin Pet Grooming - storefront" loading="lazy"
                   onerror="this.remove(); this.parentElement.style.background = placeholderBg(1);" />
              <div class="overlay"></div>
              <div class="caption">
                <p class="cap-title">A clean, premium environment</p>
                <p class="cap-sub">Warm welcome, sanitized tools, and a calm grooming flow.</p>
              </div>
            </div>

            <!-- Slide 2 -->
            <div class="slide">
              <img src="assets/2.jpg" alt="Before & after grooming" loading="lazy"
                   onerror="this.remove(); this.parentElement.style.background = placeholderBg(2);" />
              <div class="overlay"></div>
              <div class="caption">
                <p class="cap-title">Fresh look, smooth finish</p>
                <p class="cap-sub">We focus on details: paws, face, coat, and clean edges.</p>
              </div>
            </div>

            <!-- Slide 3 -->
            <div class="slide">
              <img src="assets/3.jpg" alt="Bath and blow dry" loading="lazy"
                   onerror="this.remove(); this.parentElement.style.background = placeholderBg(3);" />
              <div class="overlay"></div>
              <div class="caption">
                <p class="cap-title">Bath & Brush excellence</p>
                <p class="cap-sub">Conditioning, drying, and de-shed care for comfort.</p>
              </div>
            </div>

            <!-- Slide 4 -->
            <div class="slide">
              <img src="assets/4.jpg" alt="Full grooming service" loading="lazy"
                   onerror="this.remove(); this.parentElement.style.background = placeholderBg(4);" />
              <div class="overlay"></div>
              <div class="caption">
                <p class="cap-title">Full Grooming service</p>
                <p class="cap-sub">Trim & style tailored to your petâ€™s coat and needs.</p>
              </div>
            </div>
          </div>

          <div class="navbtn prev" role="button" aria-label="Previous" onclick="prevSlide()">â€¹</div>
          <div class="navbtn next" role="button" aria-label="Next" onclick="nextSlide()">â€º</div>

          <div class="dots" id="dots" aria-label="Slide indicators"></div>
        </div>

      </div>
    </div>

    <!-- SERVICES -->
    <div class="section" id="services">
      <h2>Services</h2>
      <div class="muted">Simple menu. Premium execution. Dogs & cats available.</div>

      <div class="grid2" style="margin-top:12px">
        <div class="card">
          <div class="service-title">Bath & Brush</div>
          <div class="service-sub">Best for routine care, de-shed, and a clean fresh coat.</div>
          <ul class="service-list">
            <li>Bath + blow dry</li>
            <li>Nail trim</li>
            <li>Paw hair & light tidy</li>
            <li>Ear cleaning</li>
            <li>Anal gland (upon request)</li>
          </ul>
        </div>

        <div class="card">
          <div class="service-title">Full Grooming</div>
          <div class="service-sub">Complete grooming with trimming and styling.</div>
          <ul class="service-list">
            <li>Bath + blow dry</li>
            <li>Hair trimming & styling</li>
            <li>Face & sanitary clean-up</li>
            <li>Nail trim + paw tidy</li>
            <li>Ear cleaning</li>
            <li>Anal gland (upon request)</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- BOOKING -->
    <div class="section" id="book">
      <h2>Book</h2>
      <div class="notice">
        Required fields are marked with <b>*</b>. After submit: (1) your text message opens with booking details, (2) we send the same details to live chat (if supported),
        and (3) a calendar file downloads with a reminder <b>1 day before</b>.
      </div>

      <div class="card" style="margin-top:12px">
        <div class="form-row">
          <div>
            <label>Owner Name <span class="req">*</span></label>
            <input id="ownerName" placeholder="Full name" autocomplete="name" />
          </div>
          <div>
            <label>Owner Phone <span class="req">*</span></label>
            <input id="ownerPhone" placeholder="(xxx) xxx-xxxx" inputmode="tel" autocomplete="tel" />
          </div>
        </div>

        <div class="form-row">
          <div>
            <label>Pet Name(s) <span class="req">*</span></label>
            <input id="petNames" placeholder="e.g., Coco / Lucky" />
          </div>
          <div>
            <label>Vaccinated? <span class="req">*</span></label>
            <select id="vaccinated">
              <option value="">Select</option>
              <option value="Yes">Yes</option>
              <option value="No">No</option>
              <option value="Not sure">Not sure</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div>
            <label>Service <span class="req">*</span></label>
            <select id="service">
              <option value="">Select</option>
              <option value="Bath & Brush">Bath & Brush</option>
              <option value="Full Grooming">Full Grooming</option>
            </select>
          </div>
          <div>
            <label>Appointment (Date & Time) <span class="req">*</span></label>
            <!-- âœ… æ—¥æœŸ+æ—¶é—´åˆå¹¶ -->
            <input id="appt" type="datetime-local" />
            <div class="small" style="margin-top:6px">Closed Tuesday. Hours: 10:00 AM â€“ 6:00 PM.</div>
          </div>
        </div>

        <div class="form-row">
          <div>
            <label>Notes (optional)</label>
            <textarea id="note" placeholder="Breed, temperament, special requests..."></textarea>
          </div>
          <div>
            <label>Reminder</label>
            <div class="sub">
              We generate a calendar reminder <b>1 day before</b>. When it pops up, open the event and tap <b>Confirm</b> to send a text.
            </div>
          </div>
        </div>

        <div class="row">
          <button class="btn primary" type="button" onclick="submitBooking()">Submit</button>
          <button class="btn ghost" type="button" onclick="clearForm()">Clear</button>
          <a class="btn ghost" href="sms:+16197540193">Text Manually</a>
        </div>

        <div id="err" class="error"></div>
        <div id="ok" class="ok"></div>
      </div>
    </div>

    <!-- LOCATION -->
    <div class="section" id="location">
      <h2>Location</h2>
      <div class="muted">Find us on Google Maps.</div>
      <div class="map-wrap" style="margin-top:12px">
        <iframe
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps?q=1680%20E%20Broadway%20Suite%20E,%20Chula%20Vista,%20CA%2091911&output=embed">
        </iframe>
      </div>
    </div>

    <!-- CONTACT -->
    <div class="section" id="contact">
      <h2>Contact</h2>
      <div class="card">
        <div class="sub">
          Phone: <b>(619) 754-0193</b><br/>
          Address: <b>1680 E Broadway Suite E, Chula Vista, CA 91911</b><br/>
          Live chat: bottom-right chat widget
        </div>
        <div class="row">
          <a class="btn success" href="tel:+16197540193">ðŸ“ž Call</a>
          <a class="btn primary" href="sms:+16197540193">ðŸ’¬ Text</a>
        </div>
      </div>
      <div class="small" style="margin-top:10px;opacity:.86">Â© <span id="year"></span> Red Dolphin Pet Grooming</div>
    </div>

  </div>

  <div class="fab">
    <a class="call" href="tel:+16197540193">ðŸ“ž Call</a>
    <a class="sms" href="sms:+16197540193?&body=Hi%20I%20would%20like%20to%20book%20pet%20grooming.">ðŸ’¬ Text</a>
  </div>

  <script>
    const BUSINESS_PHONE = "+16197540193";

    // Placeholder backgrounds (used when images are missing)
    function placeholderBg(i){
      const themes = [
        "linear-gradient(135deg, rgba(99,179,255,.22), rgba(255,255,255,.05))",
        "linear-gradient(135deg, rgba(247,211,123,.18), rgba(255,255,255,.05))",
        "linear-gradient(135deg, rgba(34,197,94,.14), rgba(255,255,255,.05))",
        "linear-gradient(135deg, rgba(99,179,255,.16), rgba(247,211,123,.12))"
      ];
      return themes[(i-1) % themes.length];
    }

    // Carousel
    let idx = 0;
    let autoTimer = null;
    const slidesEl = () => document.getElementById("slides");
    const dotsEl = () => document.getElementById("dots");
    const slideCount = () => slidesEl().children.length;

    function renderDots(){
      const n = slideCount();
      dotsEl().innerHTML = "";
      for(let i=0;i<n;i++){
        const d = document.createElement("div");
        d.className = "dot" + (i===idx ? " active":"");
        d.onclick = ()=>goTo(i);
        dotsEl().appendChild(d);
      }
    }
    function goTo(i){
      const n = slideCount();
      idx = (i + n) % n;
      slidesEl().style.transform = `translateX(-${idx*100}%)`;
      renderDots();
    }
    function nextSlide(){ goTo(idx+1); }
    function prevSlide(){ goTo(idx-1); }

    function startAuto(){
      stopAuto();
      autoTimer = setInterval(nextSlide, 5500);
    }
    function stopAuto(){
      if(autoTimer) clearInterval(autoTimer);
      autoTimer = null;
    }

    // Touch swipe for mobile
    let startX = 0;
    let down = false;
    function bindSwipe(){
      const c = document.querySelector(".carousel");
      if(!c) return;
      c.addEventListener("pointerdown", (e)=>{ down=true; startX=e.clientX; stopAuto(); });
      c.addEventListener("pointerup", (e)=>{
        if(!down) return; down=false;
        const dx = e.clientX - startX;
        if(Math.abs(dx) > 40){
          dx < 0 ? nextSlide() : prevSlide();
        }
        startAuto();
      });
      c.addEventListener("pointercancel", ()=>{ down=false; startAuto(); });
    }

    // Helpers UI
    function showError(msg){
      const el = document.getElementById("err");
      el.textContent = msg;
      el.style.display = "block";
      document.getElementById("ok").style.display = "none";
      document.getElementById("book").scrollIntoView({behavior:"smooth", block:"start"});
    }
    function showOk(msg){
      const el = document.getElementById("ok");
      el.textContent = msg;
      el.style.display = "block";
      document.getElementById("err").style.display = "none";
    }

    function clearForm(){
      ["ownerName","ownerPhone","petNames","appt","note"].forEach(id=>document.getElementById(id).value="");
      document.getElementById("vaccinated").value="";
      document.getElementById("service").value="";
      document.getElementById("err").style.display="none";
      document.getElementById("ok").style.display="none";
    }

    // Format local datetime to friendly US text
    function formatUSLocal(dt){
      try{
        return dt.toLocaleString("en-US", {
          weekday:"short",
          year:"numeric",
          month:"short",
          day:"numeric",
          hour:"numeric",
          minute:"2-digit"
        });
      }catch(e){
        return dt.toString();
      }
    }

    function buildBookingMessage(){
      const ownerName  = (document.getElementById("ownerName").value || "").trim();
      const ownerPhone = (document.getElementById("ownerPhone").value || "").trim();
      const petNames   = (document.getElementById("petNames").value || "").trim();
      const vaccinated = document.getElementById("vaccinated").value;
      const service    = document.getElementById("service").value;
      const apptRaw    = document.getElementById("appt").value;
      const note       = (document.getElementById("note").value || "").trim();

      const dt = apptRaw ? new Date(apptRaw) : null;
      const apptText = dt && !isNaN(dt.getTime()) ? formatUSLocal(dt) : apptRaw;

      return [
        "Pet Grooming Booking",
        `Owner: ${ownerName}`,
        `Owner Phone: ${ownerPhone}`,
        `Pet Name(s): ${petNames}`,
        `Vaccinated: ${vaccinated}`,
        `Service: ${service}`,
        `Appointment: ${apptText}`,
        `Notes: ${note || "N/A"}`
      ].join("\\n");
    }

    function makeConfirmSmsLink(ownerName, apptText, petNames){
      const body = encodeURIComponent(`CONFIRM - ${ownerName} - ${apptText} - ${petNames}`);
      return `sms:${BUSINESS_PHONE}?&body=${body}`;
    }

    function pad(n){ return String(n).padStart(2,"0"); }
    function toICS(dt){
      // local time (no Z) works well for Apple/Google calendars
      return `${dt.getFullYear()}${pad(dt.getMonth()+1)}${pad(dt.getDate())}T${pad(dt.getHours())}${pad(dt.getMinutes())}00`;
    }

    // Create ICS with 1-day reminder
    function downloadICS(ownerName, service, dtStart, petNames){
      if(!dtStart || isNaN(dtStart.getTime())) return;
      const dtEnd = new Date(dtStart.getTime() + 60*60*1000); // 1 hour
      const uid = `${Date.now()}-${Math.random().toString(16).slice(2)}@reddolphin`;

      const apptText = formatUSLocal(dtStart);
      const confirmLink = makeConfirmSmsLink(ownerName, apptText, petNames);

      const description =
        `Booking for: ${ownerName}\\n` +
        `Service: ${service}\\n` +
        `Pet(s): ${petNames}\\n\\n` +
        `CONFIRM (tap): ${confirmLink}\\n\\n` +
        `Reminder: Please confirm 1 day before.`;

      const ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Red Dolphin Pet Grooming//Booking//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
UID:${uid}
DTSTAMP:${toICS(new Date())}
DTSTART:${toICS(dtStart)}
DTEND:${toICS(dtEnd)}
SUMMARY:Pet Grooming - ${service}
DESCRIPTION:${description}
LOCATION:1680 E Broadway Suite E, Chula Vista, CA 91911
BEGIN:VALARM
TRIGGER:-P1D
ACTION:DISPLAY
DESCRIPTION:Confirm tomorrow's appointment. Open event and tap CONFIRM.
END:VALARM
END:VEVENT
END:VCALENDAR`;

      const blob = new Blob([ics], {type: "text/calendar;charset=utf-8"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `Booking-${dtStart.getFullYear()}-${pad(dtStart.getMonth()+1)}-${pad(dtStart.getDate())}-${ownerName.replace(/\\s+/g,"_")}.ics`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 1500);
    }

    function sendToTawk(message){
      try{
        if (window.Tawk_API && typeof window.Tawk_API.sendMessage === "function") {
          window.Tawk_API.sendMessage(message);
          return true;
        }
      }catch(e){}
      return false;
    }

    function submitBooking(){
      const ownerName  = (document.getElementById("ownerName").value || "").trim();
      const ownerPhone = (document.getElementById("ownerPhone").value || "").trim();
      const petNames   = (document.getElementById("petNames").value || "").trim();
      const vaccinated = document.getElementById("vaccinated").value;
      const service    = document.getElementById("service").value;
      const apptRaw    = document.getElementById("appt").value;

      if(!ownerName) return showError("Owner Name is required.");
      if(!ownerPhone) return showError("Owner Phone is required.");
      if(!petNames) return showError("Pet Name(s) is required.");
      if(!vaccinated) return showError("Please select vaccination status.");
      if(!service) return showError("Please select a service.");
      if(!apptRaw) return showError("Appointment (Date & Time) is required.");

      const dtStart = new Date(apptRaw);
      if(isNaN(dtStart.getTime())) return showError("Please enter a valid appointment date & time.");

      const msg = buildBookingMessage();

      // Send to Tawk (best effort)
      let sent = sendToTawk(msg);
      if(!sent){
        let tries = 0;
        const timer = setInterval(()=>{
          tries++;
          if(sendToTawk(msg) || tries>=8) clearInterval(timer);
        }, 700);
      }

      // Download ICS with 1-day reminder
      downloadICS(ownerName, service, dtStart, petNames);

      // Open SMS
      const smsBody = encodeURIComponent(msg);
      window.location.href = `sms:${BUSINESS_PHONE}?&body=${smsBody}`;

      showOk("Submitted! Please send the text to confirm booking. A calendar reminder was downloaded (1 day before).");
    }

    // Init
    document.getElementById("year").textContent = new Date().getFullYear();
    renderDots();
    bindSwipe();
    startAuto();
  </script>

  <!-- Tawk.to -->
  <script type="text/javascript">
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
      var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/698917279842801c33e38579/1jgvo4shb';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
    })();
  </script>
</body>
</html>
