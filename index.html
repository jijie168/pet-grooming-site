<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Red Dolphin Pet Grooming | Chula Vista</title>
  <meta name="description" content="Premium pet grooming in Chula Vista. Call or text to book. Bath & Brush, Full Grooming. Closed Tuesdays." />
  <meta name="theme-color" content="#0b1220" />

  <style>
    :root{
      --bg:#070a12;
      --bg2:#0b1220;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.04);
      --text:#eef2ff;
      --muted:rgba(238,242,255,.72);
      --line:rgba(255,255,255,.12);
      --shadow:0 18px 50px rgba(0,0,0,.45);
      --radius:18px;

      --brand:#2b6cff;
      --brand2:#22c55e;
      --accent:#f59e0b;

      --max:1120px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Noto Sans",sans-serif;
      background:
        radial-gradient(1200px 700px at 10% -10%, rgba(43,108,255,.22), transparent 60%),
        radial-gradient(900px 500px at 85% 5%, rgba(34,197,94,.16), transparent 55%),
        linear-gradient(180deg, var(--bg2), var(--bg));
      letter-spacing:.2px;
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--max); margin:0 auto; padding:22px}
    .glass{
      background:linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid var(--line);
      box-shadow:var(--shadow);
      border-radius:var(--radius);
    }

    /* Top bar */
    .topbar{
      position:sticky; top:0; z-index:100;
      backdrop-filter: blur(12px);
      background:rgba(7,10,18,.55);
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .topbar-inner{
      max-width:var(--max);
      margin:0 auto;
      padding:10px 22px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:900;
      letter-spacing:.3px;
    }
    .logoDot{
      width:12px;height:12px;border-radius:999px;
      background:linear-gradient(180deg, var(--brand2), #7cffc1);
      box-shadow:0 0 0 7px rgba(34,197,94,.12);
    }
    .nav{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .nav a{
      padding:8px 10px;border-radius:12px;
      color:var(--muted);border:1px solid transparent
    }
    .nav a:hover{
      color:var(--text);
      border-color:rgba(255,255,255,.14);
      background:rgba(255,255,255,.05);
    }
    .cta{display:flex; gap:10px; align-items:center}

    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid transparent;
      font-weight:800;
      cursor:pointer;
      user-select:none;
      transition:transform .08s ease, background .2s ease, border-color .2s ease;
      white-space:nowrap;
    }
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:rgba(43,108,255,.95); border-color:rgba(43,108,255,.55)}
    .btn.success{background:rgba(34,197,94,.95); border-color:rgba(34,197,94,.55); color:#04160b}
    .btn.ghost{background:rgba(255,255,255,.05); border-color:rgba(255,255,255,.14); color:var(--text)}
    .btn.warn{background:rgba(245,158,11,.14); border-color:rgba(245,158,11,.30)}

    /* Hero */
    .hero{padding:26px 0 10px}
    .heroGrid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:16px;
      align-items:stretch;
    }
    @media (max-width:980px){ .heroGrid{grid-template-columns:1fr} }

    .heroCard{ padding:22px; }
    .badge{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px;
      border-radius:999px;
      background:rgba(43,108,255,.14);
      border:1px solid rgba(43,108,255,.26);
      color:#cfe0ff;
      font-size:13px;
      font-weight:700;
    }
    h1{
      margin:12px 0 10px;
      font-size:40px;
      line-height:1.05;
      letter-spacing:-.6px;
    }
    @media (max-width:540px){ h1{font-size:34px} }
    .sub{
      color:var(--muted);
      line-height:1.65;
      font-size:15px;
    }
    .heroActions{display:flex; gap:10px; flex-wrap:wrap; margin-top:16px}

    /* Sections */
    .section{ padding:18px 0; }
    .sectionTitle{font-size:22px; margin:0 0 10px; letter-spacing:-.2px}
    .muted{color:var(--muted)}
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    @media (max-width:980px){ .grid2{grid-template-columns:1fr} }

    /* Services */
    .serviceCard{ padding:22px; }
    .serviceName{font-size:30px; font-weight:950; margin:0 0 8px}
    .serviceSub{font-size:16px; color:#dde6ff; opacity:.95; margin:0 0 10px; line-height:1.5}
    .serviceInc{font-size:16px; color:var(--text); opacity:.95; margin:0; line-height:1.6}

    /* Booking */
    .noteBox{
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(245,158,11,.28);
      background:rgba(245,158,11,.12);
      color:#ffe7b5;
      line-height:1.5;
      font-size:14px;
    }
    label{display:block; font-size:13px; color:#dbe4ff; margin:10px 0 6px}
    .req{color:#ffb4b4; font-weight:900; margin-left:6px}
    input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.22);
      color:var(--text);
      outline:none;
    }
    input:focus, select:focus, textarea:focus{
      border-color:rgba(43,108,255,.5);
      box-shadow:0 0 0 4px rgba(43,108,255,.12);
    }
    textarea{min-height:96px; resize:vertical}
    .formRow{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width:780px){ .formRow{grid-template-columns:1fr} }
    .helper{font-size:12px; color:var(--muted); margin-top:6px}
    .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}

    .msg{
      margin-top:12px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
      display:none;
      line-height:1.5;
      font-size:14px;
    }
    .msg.err{border-color:rgba(255,120,120,.35); background:rgba(255,120,120,.12); color:#ffd4d4;}
    .msg.ok{border-color:rgba(34,197,94,.35); background:rgba(34,197,94,.12); color:#d9ffe8;}

    /* ‚úÖ Real Photo Carousel */
    .carousel{
      position:relative;
      overflow:hidden;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
    }
    .track{
      display:flex;
      transition:transform .45s ease;
      will-change:transform;
      touch-action:pan-y;
    }
    .slide{
      min-width:100%;
      position:relative;
      aspect-ratio: 16 / 9;
      background:rgba(255,255,255,.04);
    }
    .slide img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      filter:saturate(1.05) contrast(1.05);
    }
    .slide:after{
      content:"";
      position:absolute; inset:0;
      background:linear-gradient(180deg, rgba(0,0,0,.15), rgba(0,0,0,.55));
      pointer-events:none;
    }
    .cap{
      position:absolute;
      left:14px; right:14px; bottom:12px;
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:10px;
      pointer-events:none;
    }
    .cap .title{
      font-weight:950;
      font-size:18px;
      text-shadow:0 8px 24px rgba(0,0,0,.6);
    }
    .cap .subt{
      font-size:13px;
      color:rgba(255,255,255,.8);
      text-shadow:0 8px 24px rgba(0,0,0,.6);
      margin-top:4px;
    }
    .cap .right{
      font-size:12px;
      color:rgba(255,255,255,.75);
      background:rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.12);
      padding:6px 10px;
      border-radius:999px;
      backdrop-filter: blur(10px);
    }

    .carBtn{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width:42px;height:42px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(18,26,43,.78);
      box-shadow:var(--shadow);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
    }
    .carBtn:hover{background:rgba(18,26,43,.92)}
    .carBtn.prev{left:12px}
    .carBtn.next{right:12px}

    .dots{
      display:flex;
      gap:8px;
      justify-content:center;
      margin-top:10px;
    }
    .dot{
      width:9px;height:9px;
      border-radius:999px;
      background:rgba(255,255,255,.22);
      border:1px solid rgba(255,255,255,.14);
      cursor:pointer;
    }
    .dot.active{
      background:rgba(43,108,255,.9);
      border-color:rgba(43,108,255,.45);
    }

    /* Map */
    .mapWrap{border-radius:18px; overflow:hidden; border:1px solid rgba(255,255,255,.12); box-shadow:var(--shadow)}
    iframe{display:block; width:100%; height:340px; border:0}

    /* Footer */
    .footer{padding:14px 0 28px; color:var(--muted); font-size:12px; opacity:.9}

    /* Floating */
    .fab{
      position:fixed; right:16px; bottom:18px;
      display:flex; flex-direction:column; gap:10px;
      z-index:150;
    }
    .fab a{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 12px;
      border-radius:999px;
      background:rgba(18,26,43,.92);
      border:1px solid rgba(255,255,255,.14);
      box-shadow:var(--shadow);
      font-weight:800;
    }
    .fab .call{border-color:rgba(34,197,94,.35)}
    .fab .sms{border-color:rgba(43,108,255,.35)}
    .fab .dir{border-color:rgba(245,158,11,.30)}
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <span class="logoDot"></span>
        <span>Red Dolphin Pet Grooming</span>
      </div>
      <div class="nav">
        <a href="#services">Services</a>
        <a href="#book">Book</a>
        <a href="#gallery">Gallery</a>
        <a href="#location">Location</a>
        <a href="#contact">Contact</a>
      </div>
      <div class="cta">
        <a class="btn success" href="tel:+16197540193">Call</a>
        <a class="btn primary" href="sms:+16197540193?&body=Hi%20Red%20Dolphin%20Pet%20Grooming,%20I'd%20like%20to%20book%20an%20appointment.">Text</a>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="hero">
      <div class="heroGrid">
        <div class="glass heroCard">
          <span class="badge">Premium care ‚Ä¢ Clean salon ‚Ä¢ Text booking</span>
          <h1>High-End Grooming.<br/>Calm, Clean, Comfortable.</h1>
          <div class="sub">
            <b>1680 E Broadway Suite E, Chula Vista, CA</b><br/>
            Phone: <b>(619) 754-0193</b><br/>
            Hours: <b>10:00 AM ‚Äì 6:00 PM</b> (Closed Tuesdays)
          </div>

          <div class="heroActions">
            <a class="btn success" href="tel:+16197540193">üìû Call Now</a>
            <a class="btn primary" href="#book">üìÖ Book Appointment</a>
            <a class="btn ghost" href="https://www.google.com/maps?q=1680%20E%20Broadway%20Suite%20E,%20Chula%20Vista,%20CA" target="_blank" rel="noopener">üìç Get Directions</a>
          </div>
        </div>

        <div class="glass heroCard">
          <div class="sectionTitle" style="margin-top:0">Quick Booking</div>
          <div class="noteBox">
            Fill the form in 20 seconds. We‚Äôll open a text message with your details.
            You‚Äôll also get a calendar reminder <b>1 day before</b> to confirm.
          </div>
          <div class="heroActions" style="margin-top:14px">
            <a class="btn primary" href="#book">Book Now</a>
            <a class="btn ghost" href="#gallery">See Photos</a>
          </div>
          <div class="sub" style="margin-top:14px">
            Prefer a quick text instead? Tap <b>Text</b> in the top right.
          </div>
        </div>
      </div>
    </div>

    <div class="section" id="services">
      <div class="sectionTitle">Services</div>
      <div class="muted">Dogs by weight and coat length ‚Ä¢ Cats available</div>

      <div class="grid2" style="margin-top:12px">
        <div class="glass serviceCard">
          <div class="serviceName">Bath & Brush</div>
          <div class="serviceSub">Gentle bath, blow dry, brush-out</div>
          <p class="serviceInc">Includes: nails, paw hair, conditioning, ears, and anal glands.</p>
        </div>

        <div class="glass serviceCard">
          <div class="serviceName">Full Grooming</div>
          <div class="serviceSub">Bath + haircut + styling</div>
          <p class="serviceInc">Includes: hair trimming, brushing, nail trimming, paw hair removal, conditioning, facial cleaning, ear cleaning, and anal gland cleaning.</p>
        </div>
      </div>
    </div>

    <!-- ‚úÖ Real Photo Carousel -->
    <div class="section" id="gallery">
      <div class="sectionTitle">Gallery</div>
      <div class="muted">Real photos from our salon. (Swipe on mobile)</div>

      <div class="carousel glass" style="margin-top:12px">
        <div class="track" id="track">
          <!-- ‚úÖ Replace these with your real photos -->
          <div class="slide">
            <img src="assets/1.jpg" alt="Red Dolphin Pet Grooming - Salon photo 1" onerror="this.onerror=null;this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%221280%22 height=%22720%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23121a2b%22/><text x=%2250%25%22 y=%2250%25%22 fill=%22%23a8b3d6%22 font-size=%2236%22 font-family=%22Arial%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22>Upload assets/1.jpg</text></svg>';">
            <div class="cap">
              <div>
                <div class="title">Clean & Calm Salon</div>
                <div class="subt">Premium products ‚Ä¢ Sanitized tools</div>
              </div>
              <div class="right">Swipe ‚Üí</div>
            </div>
          </div>

          <div class="slide">
            <img src="assets/2.jpg" alt="Red Dolphin Pet Grooming - Salon photo 2" onerror="this.onerror=null;this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%221280%22 height=%22720%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23121a2b%22/><text x=%2250%25%22 y=%2250%25%22 fill=%22%23a8b3d6%22 font-size=%2236%22 font-family=%22Arial%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22>Upload assets/2.jpg</text></svg>';">
            <div class="cap">
              <div>
                <div class="title">Before & After</div>
                <div class="subt">High-end finishing ‚Ä¢ Detail work</div>
              </div>
              <div class="right">Tap arrows</div>
            </div>
          </div>

          <div class="slide">
            <img src="assets/3.jpg" alt="Red Dolphin Pet Grooming - Salon photo 3" onerror="this.onerror=null;this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%221280%22 height=%22720%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23121a2b%22/><text x=%2250%25%22 y=%2250%25%22 fill=%22%23a8b3d6%22 font-size=%2236%22 font-family=%22Arial%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22>Upload assets/3.jpg</text></svg>';">
            <div class="cap">
              <div>
                <div class="title">Comfort First</div>
                <div class="subt">Gentle handling ‚Ä¢ Stress-free</div>
              </div>
              <div class="right">1 / 3</div>
            </div>
          </div>
        </div>

        <div class="carBtn prev" id="prev" aria-label="Previous">‚Äπ</div>
        <div class="carBtn next" id="next" aria-label="Next">‚Ä∫</div>
      </div>

      <div class="dots" id="dots" aria-label="Carousel dots"></div>
    </div>

    <!-- Booking -->
    <div class="section" id="book">
      <div class="sectionTitle">Book an Appointment</div>
      <div class="noteBox">
        Required fields are marked with <b>*</b>. Closed Tuesdays. Hours <b>10:00 AM ‚Äì 6:00 PM</b>.
        After submit: (1) we open a text message with your details, (2) a calendar reminder downloads for <b>1 day before</b> confirmation.
      </div>

      <div class="glass" style="padding:22px; margin-top:12px">
        <div class="formRow">
          <div>
            <label>Full Name <span class="req">*</span></label>
            <input id="ownerName" placeholder="Your name" autocomplete="name" />
          </div>
          <div>
            <label>Phone Number <span class="req">*</span></label>
            <input id="ownerPhone" placeholder="(619) 555-1234" inputmode="tel" autocomplete="tel" />
          </div>
        </div>

        <div class="formRow">
          <div>
            <label>Pet Name(s) <span class="req">*</span></label>
            <input id="petNames" placeholder="e.g., Coco / Lucky" />
            <div class="helper">Multiple pets? List names separated by ‚Äú/‚Äù.</div>
          </div>
          <div>
            <label>Service <span class="req">*</span></label>
            <select id="service">
              <option value="">Select</option>
              <option value="Bath & Brush">Bath & Brush</option>
              <option value="Full Grooming">Full Grooming</option>
            </select>
          </div>
        </div>

        <div class="formRow">
          <div>
            <label>Preferred Date & Time <span class="req">*</span></label>
            <input id="datetime" type="datetime-local" />
            <div class="helper">We‚Äôll confirm by text. (Closed Tuesdays)</div>
          </div>
          <div>
            <label>Notes (optional)</label>
            <textarea id="note" placeholder="Breed, size, temperament, special requests..."></textarea>
          </div>
        </div>

        <div class="row" style="margin-top:14px">
          <button class="btn primary" type="button" onclick="submitBooking()">Submit Booking</button>
          <button class="btn ghost" type="button" onclick="clearForm()">Clear</button>
          <a class="btn warn" href="sms:+16197540193">Text Manually</a>
        </div>

        <div id="err" class="msg err"></div>
        <div id="ok" class="msg ok"></div>
      </div>
    </div>

    <!-- Location -->
    <div class="section" id="location">
      <div class="sectionTitle">Location</div>
      <div class="muted">Tap ‚ÄúGet Directions‚Äù for the fastest navigation.</div>
      <div class="mapWrap" style="margin-top:12px">
        <iframe loading="lazy" referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps?q=1680%20E%20Broadway%20Suite%20E,%20Chula%20Vista,%20CA&output=embed">
        </iframe>
      </div>
    </div>

    <!-- Contact -->
    <div class="section" id="contact">
      <div class="sectionTitle">Contact</div>
      <div class="glass" style="padding:22px">
        <div class="sub">
          Phone: <b>(619) 754-0193</b><br/>
          Address: <b>1680 E Broadway Suite E, Chula Vista, CA</b><br/>
          Live chat: bottom-right chat widget
        </div>
        <div class="row" style="margin-top:14px">
          <a class="btn success" href="tel:+16197540193">üìû Call</a>
          <a class="btn primary" href="sms:+16197540193?&body=Hi%20Red%20Dolphin%20Pet%20Grooming,%20I'd%20like%20to%20book%20an%20appointment.">üí¨ Text</a>
          <a class="btn ghost" href="https://www.google.com/maps?q=1680%20E%20Broadway%20Suite%20E,%20Chula%20Vista,%20CA" target="_blank" rel="noopener">üìç Get Directions</a>
        </div>
      </div>

      <div class="footer">¬© <span id="year"></span> Red Dolphin Pet Grooming. All rights reserved.</div>
    </div>
  </div>

  <div class="fab">
    <a class="call" href="tel:+16197540193">üìû Call</a>
    <a class="sms" href="sms:+16197540193?&body=Hi%20Red%20Dolphin%20Pet%20Grooming,%20I'd%20like%20to%20book%20an%20appointment.">üí¨ Text</a>
    <a class="dir" href="https://www.google.com/maps?q=1680%20E%20Broadway%20Suite%20E,%20Chula%20Vista,%20CA" target="_blank" rel="noopener">üìç Directions</a>
  </div>

  <script>
    const BUSINESS_PHONE = "+16197540193";
    const CLOSED_WEEKDAY = 2; // Tuesday
    const OPEN_HOUR = 10;
    const CLOSE_HOUR = 18;

    function $(id){ return document.getElementById(id); }

    function showError(msg){
      const el = $("err");
      el.textContent = msg;
      el.style.display = "block";
      $("ok").style.display = "none";
      $("book").scrollIntoView({behavior:"smooth", block:"start"});
    }
    function showOk(msg){
      const el = $("ok");
      el.textContent = msg;
      el.style.display = "block";
      $("err").style.display = "none";
    }

    function clearForm(){
      ["ownerName","ownerPhone","petNames","datetime","note"].forEach(id=>$(id).value="");
      $("service").value="";
      $("err").style.display="none";
      $("ok").style.display="none";
    }

    function formatLocalDT(dt){
      const opts = { weekday:"short", month:"short", day:"numeric", year:"numeric", hour:"numeric", minute:"2-digit" };
      return dt.toLocaleString("en-US", opts);
    }

    function setMinDateTime(){
      const input = $("datetime");
      if(!input) return;
      const now = new Date();
      now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
      input.min = now.toISOString().slice(0,16);
    }

    function validateBusinessRules(dt){
      if (dt.getDay() === CLOSED_WEEKDAY) return "We are CLOSED on Tuesdays. Please choose another day.";
      const h = dt.getHours();
      if (h < OPEN_HOUR || h >= CLOSE_HOUR) return "Please choose a time between 10:00 AM and 6:00 PM.";
      if (dt.getTime() < Date.now()) return "Please choose a future date & time.";
      return "";
    }

    function onDateTimeChange(){
      const v = $("datetime").value;
      if(!v) return;
      const dt = new Date(v);
      if (isNaN(dt.getTime())) return;
      const err = validateBusinessRules(dt);
      if(err){
        alert(err);
        $("datetime").value = "";
        $("datetime").focus();
      }
    }

    function buildBookingMessage(ownerName, ownerPhone, petNames, service, dt, note){
      const when = formatLocalDT(dt);
      return [
        `Hi Red Dolphin Pet Grooming, I'd like to book an appointment.`,
        ``,
        `Name: ${ownerName}`,
        `Phone: ${ownerPhone}`,
        `Pet(s): ${petNames}`,
        `Service: ${service}`,
        `Preferred time: ${when}`,
        note ? `Notes: ${note}` : `Notes: N/A`,
        ``,
        `Thanks!`
      ].join("\n");
    }

    function makeConfirmSmsLink(ownerName, dtISO, petNames){
      const dt = new Date(dtISO);
      const when = formatLocalDT(dt);
      const body = encodeURIComponent(`CONFIRM - ${ownerName} - ${when} - ${petNames}`);
      return `sms:${BUSINESS_PHONE}?&body=${body}`;
    }

    function downloadICS(ownerName, service, dtISO, petNames){
      const dtStart = new Date(dtISO);
      if (isNaN(dtStart.getTime())) return;
      const dtEnd = new Date(dtStart.getTime() + 60*60*1000);

      function pad(n){ return String(n).padStart(2,"0"); }
      function toICS(dt){
        return `${dt.getFullYear()}${pad(dt.getMonth()+1)}${pad(dt.getDate())}T${pad(dt.getHours())}${pad(dt.getMinutes())}00`;
      }

      const confirmLink = makeConfirmSmsLink(ownerName, dtISO, petNames);
      const uid = `${Date.now()}-${Math.random().toString(16).slice(2)}@reddolphin`;

      const description =
        `Booking for: ${ownerName}\\n` +
        `Service: ${service}\\n` +
        `Pet(s): ${petNames}\\n\\n` +
        `CONFIRM (tap): ${confirmLink}\\n\\n` +
        `Reminder: Please confirm 1 day before.`;

      const ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Red Dolphin Pet Grooming//Booking//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
UID:${uid}
DTSTAMP:${toICS(new Date())}
DTSTART:${toICS(dtStart)}
DTEND:${toICS(dtEnd)}
SUMMARY:Red Dolphin - ${service}
DESCRIPTION:${description}
LOCATION:1680 E Broadway Suite E, Chula Vista, CA
BEGIN:VALARM
TRIGGER:-P1D
ACTION:DISPLAY
DESCRIPTION:Confirm tomorrow's appointment. Open event and tap CONFIRM.
END:VALARM
END:VEVENT
END:VCALENDAR`;

      const blob = new Blob([ics], {type:"text/calendar;charset=utf-8"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `Booking-${dtStart.getFullYear()}-${pad(dtStart.getMonth()+1)}-${pad(dtStart.getDate())}-${ownerName.replace(/\s+/g,"_")}.ics`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 1500);
    }

    function sendToTawk(message){
      try{
        if (window.Tawk_API && typeof window.Tawk_API.sendMessage === "function") {
          window.Tawk_API.sendMessage(message);
          return true;
        }
      }catch(e){}
      return false;
    }

    function submitBooking(){
      const ownerName  = ($("ownerName").value || "").trim();
      const ownerPhone = ($("ownerPhone").value || "").trim();
      const petNames   = ($("petNames").value || "").trim();
      const service    = $("service").value;
      const dtISO      = $("datetime").value;
      const note       = ($("note").value || "").trim();

      if(!ownerName) return showError("Full Name is required.");
      if(!ownerPhone) return showError("Phone Number is required.");
      if(!petNames) return showError("Pet Name(s) is required.");
      if(!service) return showError("Please select a service.");
      if(!dtISO) return showError("Please choose your preferred date & time.");

      const dt = new Date(dtISO);
      if(isNaN(dt.getTime())) return showError("Invalid date & time. Please try again.");

      const ruleErr = validateBusinessRules(dt);
      if(ruleErr) return showError(ruleErr);

      const msg = buildBookingMessage(ownerName, ownerPhone, petNames, service, dt, note);

      // Send to Tawk (optional)
      let sent = sendToTawk(msg);
      if(!sent){
        let tries = 0;
        const timer = setInterval(()=>{
          tries++;
          if(sendToTawk(msg) || tries>=8) clearInterval(timer);
        }, 700);
      }

      // Download calendar reminder
      downloadICS(ownerName, service, dtISO, petNames);

      // Open SMS
      window.location.href = `sms:${BUSINESS_PHONE}?&body=${encodeURIComponent(msg)}`;

      showOk("Submitted! Please send the text message to confirm. A calendar reminder was downloaded (1 day before).");
    }

    // ‚úÖ Carousel JS (autoplay + swipe)
    (function initCarousel(){
      const track = document.getElementById("track");
      const slides = Array.from(track.children);
      const prev = document.getElementById("prev");
      const next = document.getElementById("next");
      const dotsWrap = document.getElementById("dots");

      let idx = 0;
      let autoplay = true;
      let timer = null;

      function renderDots(){
        dotsWrap.innerHTML = "";
        slides.forEach((_, i)=>{
          const d = document.createElement("div");
          d.className = "dot" + (i===idx ? " active":"");
          d.addEventListener("click", ()=>go(i, true));
          dotsWrap.appendChild(d);
        });
      }

      function go(i, user=false){
        idx = (i + slides.length) % slides.length;
        track.style.transform = `translateX(-${idx*100}%)`;
        renderDots();
        if(user) restart();
      }

      function restart(){
        if(timer) clearInterval(timer);
        if(!autoplay) return;
        timer = setInterval(()=>go(idx+1), 4200);
      }

      prev.addEventListener("click", ()=>go(idx-1, true));
      next.addEventListener("click", ()=>go(idx+1, true));

      // Swipe support
      let startX = 0, currentX = 0, dragging=false;

      track.addEventListener("touchstart", (e)=>{
        dragging = true;
        startX = e.touches[0].clientX;
        currentX = startX;
        if(timer) clearInterval(timer);
      }, {passive:true});

      track.addEventListener("touchmove", (e)=>{
        if(!dragging) return;
        currentX = e.touches[0].clientX;
      }, {passive:true});

      track.addEventListener("touchend", ()=>{
        if(!dragging) return;
        dragging=false;
        const diff = currentX - startX;
        if(Math.abs(diff) > 45){
          diff < 0 ? go(idx+1, true) : go(idx-1, true);
        }else{
          go(idx, true);
        }
        restart();
      });

      renderDots();
      go(0);
      restart();
    })();

    document.addEventListener("DOMContentLoaded", ()=>{
      document.getElementById("year").textContent = new Date().getFullYear();
      setMinDateTime();
      const input = document.getElementById("datetime");
      if(input) input.addEventListener("change", onDateTimeChange);
    });
  </script>

  <!-- Tawk.to -->
  <script type="text/javascript">
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
      var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/698917279842801c33e38579/1jgvo4shb';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
    })();
  </script>
</body>
</html>
